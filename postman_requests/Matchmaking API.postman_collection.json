{
    "info": {
        "_postman_id": "9e6a2354-f673-491d-93f5-a6356d384334",
        "name": "Matchmaking API",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
        "_exporter_id": "17271797"
    },
    "item": [
        {
            "name": "Queue Management",
            "item": [
                {
                    "name": "Create Queue",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var responseJson = pm.response.json();",
                                    "    pm.environment.set('queueId', responseJson.id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"gameId\": \"{{gameId}}\",\n  \"name\": \"ranked_queue\",\n  \"description\": \"Ranked matchmaking queue\",\n  \"minPlayers\": 2,\n  \"maxPlayers\": 2,\n  \"ticketTTL\": \"00:05:00\",\n  \"turnTimeout\": \"00:01:00\",\n  \"matchTimeout\": \"00:30:00\",\n  \"queueType\": \"Asynchronous\",\n  \"rules\": {\n    \"skillRange\": 200,\n    \"minLevel\": 10,\n    \"allowParties\": false\n  },\n  \"isEnabled\": true,\n  \"useCustomMatchmaker\": false\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues"]
                        }
                    }
                },
                {
                    "name": "Get Queue",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}"]
                        }
                    }
                },
                {
                    "name": "Get Queues",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues?search=ranked&pageIndex=0&pageSize=10",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues"],
                            "query": [
                                {"key": "search", "value": "ranked"},
                                {"key": "pageIndex", "value": "0"},
                                {"key": "pageSize", "value": "10"}
                            ]
                        }
                    }
                },
                {
                    "name": "Update Queue",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"gameId\": \"{{gameId}}\",\n  \"name\": \"ranked_queue_updated\",\n  \"description\": \"Updated ranked matchmaking queue\",\n  \"minPlayers\": 2,\n  \"maxPlayers\": 4,\n  \"ticketTTL\": \"00:10:00\",\n  \"turnTimeout\": \"00:02:00\",\n  \"matchTimeout\": \"01:00:00\",\n  \"queueType\": \"Asynchronous\",\n  \"rules\": {\n    \"skillRange\": 300,\n    \"minLevel\": 15,\n    \"allowParties\": true\n  },\n  \"isEnabled\": true,\n  \"useCustomMatchmaker\": false\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}"]
                        }
                    }
                },
                {
                    "name": "Delete Queue",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}"]
                        }
                    }
                },
                {
                    "name": "Toggle Queue",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"isEnabled\": true\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}/toggle",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}", "toggle"]
                        }
                    }
                }
            ]
        },
        {
            "name": "Queue Functions",
            "item": [
                {
                    "name": "Get Queue Functions",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}/functions",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}", "functions"]
                        }
                    }
                },
                {
                    "name": "Update Queue Functions",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"initializeFunctionId\": \"{{initFunctionId}}\",\n  \"transitionFunctionId\": \"{{transitionFunctionId}}\",\n  \"leaveFunctionId\": \"{{leaveFunctionId}}\",\n  \"endFunctionId\": \"{{endFunctionId}}\"\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}/functions",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}", "functions"]
                        }
                    }
                }
            ]
        },
        {
            "name": "Queue Rules",
            "item": [
                {
                    "name": "Get Queue Rules",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}/rules",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}", "rules"]
                        }
                    }
                },
                {
                    "name": "Update Queue Rules",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"skillRange\": 300,\n  \"minLevel\": 15,\n  \"allowParties\": true,\n  \"regionLock\": true,\n  \"customRules\": {\n    \"maxPing\": 100,\n    \"minRank\": \"silver\"\n  }\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}/rules",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}", "rules"]
                        }
                    }
                }
            ]
        },
        {
            "name": "Matchmaking Process",
            "item": [
                {
                    "name": "Create Ticket",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var responseJson = pm.response.json();",
                                    "    pm.environment.set('ticketId', responseJson.id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"queueName\": \"ranked_queue\",\n  \"properties\": {\n    \"skill\": 1500,\n    \"level\": 20,\n    \"preferredRegion\": \"eu-west\"\n  }\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/tickets",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "tickets"]
                        }
                    }
                },
                {
                    "name": "Get Ticket",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/tickets/{{ticketId}}",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "tickets", "{{ticketId}}"]
                        }
                    }
                },
                {
                    "name": "Process Matchmaking",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/process?queueId={{queueId}}",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "process"],
                            "query": [
                                {"key": "queueId", "value": "{{queueId}}"}
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "Match Management",
            "item": [
                {
                    "name": "Get Match",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}"]
                        }
                    }
                },
                {
                    "name": "Get Match State",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}/state",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}", "state"]
                        }
                    }
                },
                {
                    "name": "Mark Player Ready",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}/players/{{playerId}}/ready",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}", "players", "{{playerId}}", "ready"]
                        }
                    }
                },
                {
                    "name": "Update Player Presence",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "PUT",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"sessionId\": \"{{sessionId}}\",\n  \"status\": \"online\",\n  \"meta\": {\n    \"lastAction\": \"move\",\n    \"timestamp\": \"2024-01-01T12:00:00Z\"\n  }\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}/players/{{playerId}}/presence",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}", "players", "{{playerId}}", "presence"]
                        }
                    }
                },
                {
                    "name": "Submit Action",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"type\": \"move\",\n  \"data\": {\n    \"position\": { \"x\": 10, \"y\": 20 },\n    \"direction\": \"north\"\n  }\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}/players/{{playerId}}/actions",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}", "players", "{{playerId}}", "actions"]
                        }
                    }
                },
                {
                    "name": "Get Match Actions",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}/actions?since=2024-01-01T00:00:00Z&limit=50",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}", "actions"],
                            "query": [
                                {"key": "since", "value": "2024-01-01T00:00:00Z"},
                                {"key": "limit", "value": "50"}
                            ]
                        }
                    }
                },
                {
                    "name": "Leave Match",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}/players/{{playerId}}/leave",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}", "players", "{{playerId}}", "leave"]
                        }
                    }
                },
                {
                    "name": "End Match",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"finalState\": {\n    \"winner\": \"{{playerId}}\",\n    \"scores\": {\n      \"{{playerId}}\": 100,\n      \"{{otherPlayerId}}\": 80\n    },\n    \"gameStats\": {\n      \"duration\": 600,\n      \"moves\": 42\n    }\n  }\n}",
                            "options": {"raw": {"language": "json"}}
                        },
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/matches/{{matchId}}/end",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "matches", "{{matchId}}", "end"]
                        }
                    }
                }
            ]
        },
        {
            "name": "Statistics",
            "item": [
                {
                    "name": "Get Matchmaking Stats",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/stats?gameId={{gameId}}&queueIds={{queueId1}},{{queueId2}}&timeRange=24h",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "stats"],
                            "query": [
                                {"key": "gameId", "value": "{{gameId}}"},
                                {"key": "queueIds", "value": "{{queueId1}},{{queueId2}}"},
                                {"key": "timeRange", "value": "24h"}
                            ]
                        }
                    }
                },
                {
                    "name": "Get Queue Activity",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}/activity?timeRange=7d",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}", "activity"],
                            "query": [
                                {"key": "timeRange", "value": "7d"}
                            ]
                        }
                    }
                },
                {
                    "name": "Get Queue Dashboard",
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [{"key": "token", "value": "{{accessToken}}", "type": "string"}]
                        },
                        "method": "GET",
                        "header": [
                            {
                                "key": "X-Game-Key",
                                "value": "{{gameKey}}",
                                "type": "text"
                            }
                        ],
                        "url": {
                            "raw": "{{baseUrl}}/api/v1/matchmaking/queues/{{queueId}}/dashboard",
                            "host": ["{{baseUrl}}"],
                            "path": ["api", "v1", "matchmaking", "queues", "{{queueId}}", "dashboard"]
                        }
                    }
                }
            ]
        }
    ],
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "if (!pm.environment.get('baseUrl')) {",
                    "    pm.environment.set('baseUrl', 'https://localhost:7257');",
                    "}"
                ]
            }
        }
    ]
}